// ... (c√≥digo existente)

function executeAutomation() {
    console.log('Iniciando automatizaci√≥n...');
    
    // 1. Obtener una referencia al iframe
    const panelIframe = document.getElementById('panel');

    // 2. Verificar si el iframe existe y si su contenido est√° cargado
    if (!panelIframe || !panelIframe.contentDocument) {
        console.error('‚ùå No se pudo acceder al contenido del iframe.');
        alert('No se pudo acceder al contenido del iframe. Aseg√∫rate de que la p√°gina se haya cargado completamente.');
        return;
    }
    
    // 3. Usar el documento del iframe para buscar los campos
    const iframeDocument = panelIframe.contentDocument;

    const numeroJuicioField = iframeDocument.querySelector('input[name="juicio"]');
    const a√±oField = iframeDocument.querySelector('input[name="anio"]');
    const buscarButton = iframeDocument.querySelector('input[name="buscar"]') || 
                         iframeDocument.querySelector('button[name="buscar"]') ||
                         iframeDocument.querySelector('[name="buscar"]');
    
    // ... (El resto del c√≥digo de la funci√≥n sigue igual,
    //      pero ahora usa las variables numeroJuicioField, a√±oField y buscarButton
    //      que fueron encontradas dentro del iframe)
    
    if (numeroJuicioField && a√±oField && buscarButton) {
        console.log('‚úÖ Todos los campos encontrados dentro del iframe, completando formulario...');
        
        // Limpiar y completar campos
        numeroJuicioField.value = '556402';
        a√±oField.value = '2025';
        
        // Disparar eventos
        numeroJuicioField.dispatchEvent(new Event('input', { bubbles: true }));
        a√±oField.dispatchEvent(new Event('input', { bubbles: true }));

        setTimeout(() => {
            console.log('üîç Ejecutando b√∫squeda...');
            buscarButton.click();
        }, 800);
    } else {
        console.log('‚ùå No se encontraron todos los campos necesarios dentro del iframe.');
        alert('No se pudieron encontrar todos los campos necesarios.');
        console.log({ numeroJuicioField, a√±oField, buscarButton });
    }
}

// ... (El resto del c√≥digo de la extensi√≥n)
